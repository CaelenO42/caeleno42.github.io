<!DOCTYPE html>
<html>
   <head>
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
      <title>CG Novemeber 2022 Food Tracker</title>
      <link rel="icon" href="../images/favicon.png" />
      <script src="https://kit.fontawesome.com/56b07f00c9.js" crossorigin="anonymous"></script>
      <link rel="stylesheet" type="text/css" href="css/food.css" />
   </head>
   <body>
      <div class="item_container">
         <div class="item">
            <img src="./images/apple.png" class="icon" />
            <span>Apple (x64)</span>
            <fieldset data-quantity id="0"></fieldset>
         </div>
         <div class="item">
            <img src="./images/baked_potato.png" class="icon" />
            <span>Baked Potato (x64)</span>
            <fieldset data-quantity id="1"></fieldset>
         </div>
         <div class="item">
            <img src="./images/beetroot.png" class="icon" />
            <span>Beetroot (x64)</span>
            <fieldset data-quantity id="2"></fieldset>
         </div>
         <div class="item">
            <img src="./images/beetroot_soup.png" class="icon" />
            <span>Beetroot Soup (x15)</span>
            <fieldset data-quantity id="3"></fieldset>
         </div>
         <div class="item">
            <img src="./images/bread.png" class="icon" />
            <span>Bread (x64)</span>
            <fieldset data-quantity id="4"></fieldset>
         </div>
         <div class="item">
            <img src="./images/cake.png" class="icon" />
            <span>Cake (x15)</span>
            <fieldset data-quantity id="5"></fieldset>
         </div>
         <div class="item">
            <img src="./images/carrot.png" class="icon" />
            <span>Carrot (x64)</span>
            <fieldset data-quantity id="6"></fieldset>
         </div>
         <div class="item">
            <img src="./images/chorus_fruit.png" class="icon" />
            <span>Chorus Fruit (x64)</span>
            <fieldset data-quantity id="7"></fieldset>
         </div>
         <div class="item">
            <img src="./images/cooked_beef.png" class="icon" />
            <span>Cooked Beef (x64)</span>
            <fieldset data-quantity id="8"></fieldset>
         </div>
         <div class="item">
            <img src="./images/cooked_chicken.png" class="icon" />
            <span>Cooked Chicken (x64)</span>
            <fieldset data-quantity id="9"></fieldset>
         </div>
         <div class="item">
            <img src="./images/cooked_cod.png" class="icon" />
            <span>Cooked Cod (x64)</span>
            <fieldset data-quantity id="10"></fieldset>
         </div>
         <div class="item">
            <img src="./images/cooked_mutton.png" class="icon" />
            <span>Cooked Mutton (x64)</span>
            <fieldset data-quantity id="11"></fieldset>
         </div>
         <div class="item">
            <img src="./images/cooked_porkchop.png" class="icon" />
            <span>Cooked Porkchop (x64)</span>
            <fieldset data-quantity id="12"></fieldset>
         </div>
         <div class="item">
            <img src="./images/cooked_rabbit.png" class="icon" />
            <span>Cooked Rabbit (x64)</span>
            <fieldset data-quantity id="13"></fieldset>
         </div>
         <div class="item">
            <img src="./images/cooked_salmon.png" class="icon" />
            <span>Cooked Salmon (x64)</span>
            <fieldset data-quantity id="14"></fieldset>
         </div>
         <div class="item">
            <img src="./images/cookie.png" class="icon" />
            <span>Cookie (x64)</span>
            <fieldset data-quantity id="15"></fieldset>
         </div>
         <div class="item">
            <img src="./images/dried_kelp.png" class="icon" />
            <span>Dried Kelp (x64)</span>
            <fieldset data-quantity id="16"></fieldset>
         </div>
         <div class="item">
            <img src="./images/enchanted_golden_apple.gif" class="icon" />
            <span>Enchanted Golden Apple (x1)</span>
            <fieldset data-quantity id="17"></fieldset>
         </div>
         <div class="item">
            <img src="./images/glow_berries.png" class="icon" />
            <span>Glow Berries (x64)</span>
            <fieldset data-quantity id="18"></fieldset>
         </div>
         <div class="item">
            <img src="./images/golden_apple.png" class="icon" />
            <span>Golden Apple (x25)</span>
            <fieldset data-quantity id="19"></fieldset>
         </div>
         <div class="item">
            <img src="./images/golden_carrot.png" class="icon" />
            <span>Golden Carrot (x64)</span>
            <fieldset data-quantity id="20"></fieldset>
         </div>
         <div class="item">
            <img src="./images/honey_bottle.png" class="icon" />
            <span>Honey Bottle (x15)</span>
            <fieldset data-quantity id="21"></fieldset>
         </div>
         <div class="item">
            <img src="./images/melon_slice.png" class="icon" />
            <span>Melon Slice (x64)</span>
            <fieldset data-quantity id="22"></fieldset>
         </div>
         <div class="item">
            <img src="./images/mushroom_stew.png" class="icon" />
            <span>Mushroom Stew (x15)</span>
            <fieldset data-quantity id="23"></fieldset>
         </div>
         <div class="item">
            <img src="./images/potato.png" class="icon" />
            <span>Potato (x64)</span>
            <fieldset data-quantity id="24"></fieldset>
         </div>
         <div class="item">
            <img src="./images/pumpkin_pie.png" class="icon" />
            <span>Pumpkin Pie (x64)</span>
            <fieldset data-quantity id="25"></fieldset>
         </div>
         <div class="item">
            <img src="./images/rabbit_stew.png" class="icon" />
            <span>Rabbit Stew (x15)</span>
            <fieldset data-quantity id="26"></fieldset>
         </div>
         <div class="item">
            <img src="./images/suspicious_stew.png" class="icon" />
            <span>Suspicious Stew (x15)</span>
            <fieldset data-quantity id="27"></fieldset>
         </div>
         <div class="item">
            <img src="./images/sweet_berries.png" class="icon" />
            <span>Sweet Berries (x64)</span>
            <fieldset data-quantity id="28"></fieldset>
         </div>
      </div>

      <div class="controls">
         <input id="username" placeholder="Username" />
         <button onclick="submitFunction()">Submit</button>
         <button onclick="clearFunction()">Clear All Data</button>
         <span id="warning"></span>
      </div>

      <div class="point_totals"></div>

      <div class="info_background" onclick="toggleInfo()" style="display: none">
         <div class="info">
            <div class="item">
               <img src="https://mc-heads.net/avatar/" class="icon" id="data_image" />
               <span id="data_name">Name</span>
               <p id="data_29">0</p>
            </div>
            <div class="item">
               <img src="./images/apple.png" class="icon" />
               <span>Apple (x64)</span>
               <p id="data_0">0</p>
            </div>
            <div class="item">
               <img src="./images/baked_potato.png" class="icon" />
               <span>Baked Potato (x64)</span>
               <p id="data_1">0</p>
            </div>
            <div class="item">
               <img src="./images/beetroot.png" class="icon" />
               <span>Beetroot (x64)</span>
               <p id="data_2">0</p>
            </div>
            <div class="item">
               <img src="./images/beetroot_soup.png" class="icon" />
               <span>Beetroot Soup (x15)</span>
               <p id="data_3">0</p>
            </div>
            <div class="item">
               <img src="./images/bread.png" class="icon" />
               <span>Bread (x64)</span>
               <p id="data_4">0</p>
            </div>
            <div class="item">
               <img src="./images/cake.png" class="icon" />
               <span>Cake (x15)</span>
               <p id="data_5">0</p>
            </div>
            <div class="item">
               <img src="./images/carrot.png" class="icon" />
               <span>Carrot (x64)</span>
               <p id="data_6">0</p>
            </div>
            <div class="item">
               <img src="./images/chorus_fruit.png" class="icon" />
               <span>Chorus Fruit (x64)</span>
               <p id="data_7">0</p>
            </div>
            <div class="item">
               <img src="./images/cooked_beef.png" class="icon" />
               <span>Cooked Beef (x64)</span>
               <p id="data_8">0</p>
            </div>
            <div class="item">
               <img src="./images/cooked_chicken.png" class="icon" />
               <span>Cooked Chicken (x64)</span>
               <p id="data_9">0</p>
            </div>
            <div class="item">
               <img src="./images/cooked_cod.png" class="icon" />
               <span>Cooked Cod (x64)</span>
               <p id="data_10">0</p>
            </div>
            <div class="item">
               <img src="./images/cooked_mutton.png" class="icon" />
               <span>Cooked Mutton (x64)</span>
               <p id="data_11">0</p>
            </div>
            <div class="item">
               <img src="./images/cooked_porkchop.png" class="icon" />
               <span>Cooked Porkchop (x64)</span>
               <p id="data_12">0</p>
            </div>
            <div class="item">
               <img src="./images/cooked_rabbit.png" class="icon" />
               <span>Cooked Rabbit (x64)</span>
               <p id="data_13">0</p>
            </div>
            <div class="item">
               <img src="./images/cooked_salmon.png" class="icon" />
               <span>Cooked Salmon (x64)</span>
               <p id="data_14">0</p>
            </div>
            <div class="item">
               <img src="./images/cookie.png" class="icon" />
               <span>Cookie (x64)</span>
               <p id="data_15">0</p>
            </div>
            <div class="item">
               <img src="./images/dried_kelp.png" class="icon" />
               <span>Dried Kelp (x64)</span>
               <p id="data_16">0</p>
            </div>
            <div class="item">
               <img src="./images/enchanted_golden_apple.gif" class="icon" />
               <span>Enchanted Golden Apple (x1)</span>
               <p id="data_17">0</p>
            </div>
            <div class="item">
               <img src="./images/glow_berries.png" class="icon" />
               <span>Glow Berries (x64)</span>
               <p id="data_18">0</p>
            </div>
            <div class="item">
               <img src="./images/golden_apple.png" class="icon" />
               <span>Golden Apple (x25)</span>
               <p id="data_19">0</p>
            </div>
            <div class="item">
               <img src="./images/golden_carrot.png" class="icon" />
               <span>Golden Carrot (x64)</span>
               <p id="data_20">0</p>
            </div>
            <div class="item">
               <img src="./images/honey_bottle.png" class="icon" />
               <span>Honey Bottle (x15)</span>
               <p id="data_21">0</p>
            </div>
            <div class="item">
               <img src="./images/melon_slice.png" class="icon" />
               <span>Melon Slice (x64)</span>
               <p id="data_22">0</p>
            </div>
            <div class="item">
               <img src="./images/mushroom_stew.png" class="icon" />
               <span>Mushroom Stew (x15)</span>
               <p id="data_23">0</p>
            </div>
            <div class="item">
               <img src="./images/potato.png" class="icon" />
               <span>Potato (x64)</span>
               <p id="data_24">0</p>
            </div>
            <div class="item">
               <img src="./images/pumpkin_pie.png" class="icon" />
               <span>Pumpkin Pie (x64)</span>
               <p id="data_25">0</p>
            </div>
            <div class="item">
               <img src="./images/rabbit_stew.png" class="icon" />
               <span>Rabbit Stew (x15)</span>
               <p id="data_26">0</p>
            </div>
            <div class="item">
               <img src="./images/suspicious_stew.png" class="icon" />
               <span>Suspicious Stew (x15)</span>
               <p id="data_27">0</p>
            </div>
            <div class="item">
               <img src="./images/sweet_berries.png" class="icon" />
               <span>Sweet Berries (x64)</span>
               <p id="data_28">0</p>
            </div>
         </div>
      </div>

      <script type="module">
         import QuantityInput from "./js/quantity.js";

         // Set up quantity forms
         (function () {
            let quantities = document.querySelectorAll("[data-quantity]");

            if (quantities instanceof Node) quantities = [quantities];
            if (quantities instanceof NodeList) quantities = [].slice.call(quantities);
            if (quantities instanceof Array) {
               quantities.forEach((div) => (div.quantity = new QuantityInput(div, '<i class="fa-solid fa-minus"></i>', '<i class="fa-solid fa-plus"></i>')));
            }
         })();
      </script>
      <script>
         var worth = [40, 50, 30, 15, 100, 70, 70, 50, 100, 90, 90, 90, 90, 90, 90, 20, 10, 50, 10, 150, 170, 50, 30, 40, 30, 100, 40, 50, 10];
         var data = {};
         var infoVisible = false;

         if (localStorage.getItem("cgFoodData")) {
            data = JSON.parse(localStorage.getItem("cgFoodData"));
            loadData();
         }

         function loadData() {
            let keys = Object.keys(data);

            for (var i = 0; i < keys.length; i++) {
               $(".point_totals").append(`<div class="user"><img src="https://mc-heads.net/avatar/${keys[i]}" /> <a href="#" onclick="infoFunction('${keys[i]}')">${keys[i]}: ${data[keys[i]][29]}</a></div>`);
            }
         }

         function submitFunction() {
            let pointTotal = 0;
            let username = $("#username").val();
            let temp = [];

            for (var i = 0; i < 29; i++) {
               pointTotal += parseInt($(`#${i}`).children("input").val()) * worth[i];
               temp.push(parseInt($(`#${i}`).children("input").val()));
               $(`#${i}`).children("input").val(0);
            }

            temp.push(pointTotal);

            data[username] = temp;

            $(".point_totals").append(`<div class="user"><img src="https://mc-heads.net/avatar/${username}" /> <a href="#" onclick="infoFunction('${username}')">${username}: ${pointTotal}</a></div>`);
            console.log(pointTotal);

            $("#username").val("");
         }

         function infoFunction(username) {
            let userData = data[username];

            console.log(userData);

            $("#data_image").attr("src", `https://mc-heads.net/avatar/${username}`);
            $("#data_name").html(username);

            for (var i = 0; i < 29; i++) {
               $(`#data_${i}`).html(`${userData[i]} x ${worth[i]} = ${userData[i] * worth[i]}`);
            }

            $(`#data_29`).html(userData[29]);

            toggleInfo();
         }

         function toggleInfo() {
            if (infoVisible) {
               $(".info_background").fadeOut(500);
               infoVisible = false;
            } else {
               $(".info_background").fadeIn(500);
               infoVisible = true;
            }
         }

         function clearFunction() {
            $(".point_totals").html("");
            data = {};
            localStorage.removeItem("cgFoodData");
         }

         $(".info_background .info").click(function (e) {
            e.stopPropagation();
         });

         $(window).on("pagehide", function () {
            localStorage.setItem("cgFoodData", JSON.stringify(data));
         });
      </script>
   </body>
</html>
